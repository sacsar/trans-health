PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE company (
	id INTEGER NOT NULL, 
	name VARCHAR(250) NOT NULL, 
	PRIMARY KEY (id)
);
INSERT INTO "company" VALUES(1,'Humana');
INSERT INTO "company" VALUES(2,'Blue Cross and Blue Shield');
INSERT INTO "company" VALUES(3,'Cigna');
INSERT INTO "company" VALUES(4,'Amerigroup');
CREATE TABLE "plan" (
	id INTEGER NOT NULL, 
	company_id INTEGER NOT NULL, 
	name VARCHAR(250) NOT NULL, 
	state VARCHAR(20) NOT NULL, 
	color_code VARCHAR(12), 
	medicaid BOOLEAN NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(company_id) REFERENCES company (id), 
	CHECK (color_code IN ('bronze', 'silver', 'gold', 'platinum', 'catastrophic', 'not-present')), 
	CHECK (medicaid IN (0, 1))
);
INSERT INTO "plan" VALUES(1,3,'myCigna Health Savings','TX','bronze',0);
INSERT INTO "plan" VALUES(2,1,'Humana Basic 6600','TX','catastrophic',0);
INSERT INTO "plan" VALUES(3,1,'blue Advantage Bronze HMO','TX','bronze',0);
INSERT INTO "plan" VALUES(4,1,'Humana Bronze 6300','TX','bronze',0);
INSERT INTO "plan" VALUES(5,2,'Blue Advantage Gold HMO 002','TX','gold',0);
INSERT INTO "plan" VALUES(6,4,'STAR Medicaid','TX','not-present',1);
CREATE TABLE incident (
	id INTEGER NOT NULL, 
	date DATE NOT NULL, 
	plan_id INTEGER NOT NULL, 
	procedure VARCHAR(250) NOT NULL, 
	stated_gender VARCHAR(1) NOT NULL, 
	success BOOLEAN NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(plan_id) REFERENCES "plan" (id), 
	CHECK (stated_gender IN ('M', 'F', 'U')), 
	CHECK (success IN (0, 1))
);
CREATE TABLE coverage_statement (
	id INTEGER NOT NULL, 
	date DATE NOT NULL, 
	plan_id INTEGER NOT NULL, 
	procedure VARCHAR(250) NOT NULL, 
	covered VARCHAR(7) NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(plan_id) REFERENCES "plan" (id), 
	CHECK (covered IN ('true', 'false', 'unknown'))
);
CREATE TABLE documents (
	id INTEGER NOT NULL, 
	plan_id INTEGER NOT NULL, 
	coverage_statement_id INTEGER NOT NULL, 
	date DATE NOT NULL, 
	PRIMARY KEY (id), 
	FOREIGN KEY(plan_id) REFERENCES "plan" (id), 
	FOREIGN KEY(coverage_statement_id) REFERENCES coverage_statement (id)
);
COMMIT;
